---
phase: 12-dry-run-mode
plan: 01
type: tdd
---

<objective>
Add GetSteps method to lifecycle executor for dry-run preview.

Purpose: Enable commands to show what workflows would execute without running them.
Output: GetSteps method that returns lifecycle steps for a story without executing.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/references/tdd.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-error-recovery-resume/11-01-SUMMARY.md

**Key files:**
@internal/lifecycle/executor.go
@internal/lifecycle/executor_test.go
@internal/router/lifecycle.go

**Established patterns:**

- Executor struct with dependency injection
- MockWorkflowRunner, MockStatusReader, MockStatusWriter for tests
- Table-driven tests with testify/assert
  </context>

<feature>
  <name>GetSteps - Preview lifecycle without executing</name>
  <files>internal/lifecycle/executor.go, internal/lifecycle/executor_test.go</files>
  <behavior>
    Given a story key, GetSteps returns the sequence of lifecycle steps that would execute:
    - Input: "EPIC-1-story" with status backlog → Output: []LifecycleStep for create-story, dev-story, code-review, git-commit
    - Input: "EPIC-1-story" with status ready-for-dev → Output: []LifecycleStep for dev-story, code-review, git-commit
    - Input: "EPIC-1-story" with status review → Output: []LifecycleStep for code-review, git-commit
    - Input: "EPIC-1-story" with status done → Error: router.ErrStoryComplete
    - Input: "unknown-story" (status read error) → Error: propagated error

    Method signature: `func (e *Executor) GetSteps(storyKey string) ([]router.LifecycleStep, error)`

    Does NOT call runner.RunSingle or statusWriter.UpdateStatus.

  </behavior>
  <implementation>
    Add GetSteps method that:
    1. Reads current status via statusReader.GetStoryStatus
    2. Calls router.GetLifecycle to get steps
    3. Returns steps directly (no execution)

    This reuses existing logic from Execute but stops before the execution loop.

  </implementation>
</feature>

<verification>
go test ./internal/lifecycle/... -v
</verification>

<success_criteria>

- Failing test written and committed (RED)
- Implementation passes all tests (GREEN)
- GetSteps method available for commands to use
- No changes to Execute method behavior
  </success_criteria>

<output>
After completion, create `.planning/phases/12-dry-run-mode/12-01-SUMMARY.md`:

# Phase 12 Plan 01: GetSteps Method Summary

**[One-liner describing what was built]**

## RED Phase

[Tests written, why they failed]

## GREEN Phase

[Implementation that made tests pass]

## REFACTOR Phase

[Cleanup done, or "None needed"]

## Commits

[List of commits]

## Files Created/Modified

- `internal/lifecycle/executor.go` - Added GetSteps method
- `internal/lifecycle/executor_test.go` - Added GetSteps tests

## Next Step

Ready for 12-02-PLAN.md: Add --dry-run flag to commands
</output>
